---
title: "Sentiment"
author: "Daisy Kiyemba"
date: "2025-06-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, echo=FALSE}
#working directory
setwd('C:\\Users\\deeda\\Desktop\\Brandeis\\NLP manuscript\\Sentiment_Regression') 

#clear workspace
rm(list=ls())

#importing & reading voice data
vol <- read.csv('Volume - updated_data_vol.csv')

```



```{r, echo=FALSE}
#loading packages to use
suppressMessages(require(tidyverse))
suppressMessages(require(rempsyc))
suppressMessages(require(psych))
suppressMessages(require(interactions))


```



#just for stats

```{r, echo=FALSE}
#getting stats
stats <- read.csv("Copy of Volume - working_vol.csv")

stats_data <- na.omit(stats) #removed 6 for missing  data

#checking for outliers
columns <- c("Total_hippo", "Total_amygdala", "avg_positive", "avg_neutral", "avg_negative")

# Identify outliers in selected columns
# Compute Z-scores
z_scores_data <- scale(stats_data[, columns])

# Identify rows where any selected column has |Z| > 3
outlier_rows <- apply(abs(z_scores_data) > 3, 1, any)

# Remove those rows
stats_data_cleaned <- stats_data[!outlier_rows, ]

stats_data_cleaned <- stats_data_cleaned%>%
  mutate(
    Sex = as.factor(Sex),
    Race =as.factor(Race))


summary(stats_data_cleaned)

```









```{r, echo=FALSE}

#check for missing values
(missing <- sum(is.na(vol))) #missing_values = 36

#exclude missing data

data <- na.omit(vol)

#making sure sex, timedelay, race are categorical variables
# Convert Race, sex, and time.delay.minutes to factors
data <- data %>%
  mutate(
    sex = as.factor(Sex),
    edu = as.numeric(Education),
    timedelay = as.numeric(timedelay),
    hippo = Total_hippo,
    amygdala = Total_amygdala,
    ICV = EstimatedTotalIntraCranialVol,
    L_hippo = Left.Hippocampus,
    R_hippo = Right.Hippocampus,
    L_amyg = Left.Amygdala,
    R_amyg = Right.Amygdala
    
    )

head(data, 5)

#summary(data)



```



```{r}
#creating composite scores
#scaling variables
# data <- data %>%
#   mutate(across(c(WMS_LD, CVLT_LD, FNAME_LD), scale))

#episodic
# data <- data %>%
#   mutate(episodic = rowMeans(select(., 'WMS_LD', 'CVLT_LD', 'FNAME_LD'), na.rm = TRUE))




```



## Scatterplots

```{r, echo=TRUE}

#raw plot
# plot(subset(data, 
#             select = c(VD, GDS, amygdala, hippo)))

# plot(subset(data, 
#             select = c(VD, GDS, L_amyg, R_amyg, amygdala, L_hippo, R_hippo, hippo)))

```



#outliers check

```{r}

library(performance)
#check_outliers(data)

plot(check_outliers(data$Total_hippo))
plot(check_outliers(data$Total_amygdala))

#checking for outliers
columns_to_check <- c("Total_hippo", "Total_amygdala", "avg_positive", "avg_neutral", "avg_negative")

# Identify outliers in selected columns
# Compute Z-scores
z_scores <- scale(data[, columns_to_check])

# Identify rows where any selected column has |Z| > 3
outlier_rows <- apply(abs(z_scores) > 3, 1, any)

# Remove those rows
dataX <- data[!outlier_rows, ]

#visually checking again
#plot(check_outliers(dataX$Total_hippo))
#plot(check_outliers(dataX$Total_amygdala))


#four participant removed as an outliers

```






> descriptive statistics

```{r}


describe(dataX)


```




#controlling for intra-cranial volume

```{r}

model_hippo <- lm(hippo ~ ICV, dataX)
model_L_hippo <- lm(L_hippo ~ ICV, dataX)
model_R_hippo <- lm(R_hippo ~ ICV, dataX)

model_amyg <- lm(amygdala ~ ICV, dataX)
model_L_amyg <- lm(L_amyg ~ ICV, dataX)
model_R_amyg <- lm(R_amyg ~ ICV, dataX)

#residual extraction
dataX$Hippo_R <- residuals(model_hippo)
dataX$L_hippo_r <- residuals(model_L_hippo)
dataX$R_hippo_r <- residuals(model_R_hippo)

dataX$Amyg_R <- residuals(model_amyg)
dataX$L_amyg_r <- residuals(model_L_amyg)
dataX$R_amyg_r <- residuals(model_R_amyg)


```



#plotting with residuals

```{r}

#raw plot
plot(subset(dataX, 
            select = c(VD, GDS, Amyg_R, Hippo_R)))


```




#Correlation 

```{r}

mycor <- dataX %>% 
  dplyr::select(VD, Age, Education, GDS, avg_positive, avg_neutral, avg_negative, Amyg_R, Hippo_R) 

#cor(mycor)


#cor.test(data$VD, data$episodic)

library(apaTables)

apa.cor.table(mycor,
              filename = "Correlation2.doc",
              table.number = 1)




```



## Visulaizing Correlation Relationships 

```{r}

#Negative sentiment & Age

nice_scatter(dataX, predictor ="Age", response = "avg_negative", 
             ytitle = "Negative content",
             xtitle = "Age",
             #has.points = FALSE,
             has.jitter = TRUE,
             alpha = .7,
             #has.confband = TRUE,
             #has.fullrange = TRUE,
             has.r = TRUE, r.x =80, r.y = .22, 
             has.p = TRUE, p.x =80, p.y = .2, 
            ) + 
  
  #adding this function to get a customized color for line & confidence bands
  geom_smooth(
    method = "lm", 
    se     = TRUE, 
    color  = "black",       # regression line
    fill   = "Forestgreen",   # ribbon color
    #alpha  = 0.3
  ) +
  
  #to customize the theme such as font size
  theme(
    axis.title.x = element_text(size = 18),  # choose whatever point size you like
    axis.title.y = element_text(size = 18)
  )




```










&nbsp;


## Hippocampal Models

> Positive sentiment Models

```{r, echo=TRUE}
# Fit the multiple linear regression model
m1a <- lm(VD ~ GDS + avg_positive + Hippo_R, dataX)

m1b <- lm(VD ~ GDS*avg_positive + Age + sex + edu + films + timedelay, dataX)
#m1b <- lm(VD ~ GDS + avg_positive + Hippo_R + Age + sex + edu + films + timedelay, dataX)

m1c <- lm(VD ~ avg_positive*Hippo_R + GDS + Age + sex + edu + films + timedelay, dataX)

m1d <- lm(VD ~ avg_positive*Hippo_R + GDS*avg_positive + Age + sex + edu + films + timedelay, dataX)



#to summarize the four model results
texreg::screenreg(list(m1a, m1b, m1c, m1d),
                  caption = "",
          custom.note = "Note: ***p<.001, **p<.01, *p<.05,  
          Model 1: hippo, 
          Model 2: m1a + covariates,
          Model 3: m1b + films,
          Model 4: m1b + GDS,
          Model 5: interaction"
          )

```

#replicating past results

```{r}
summary(m1b) #depression model

summary(m1c)

```






```{r}
#graphical presentation of the interaction
 interact_plot(m1b, pred=GDS, modx=avg_positive,
              interval   = TRUE,       # adding CI bands
              plot.points= TRUE,
              jitter = 0.2,
              colors   = c("black", "brown2"),
              x.label    = "Level of depressive symptoms",
              y.label    = "Film recall",
             legend.main= "Positive content",
             
) + 
  
  theme(
    legend.position    = "bottom",             # move legend above the panel
    #legend.direction   = "horizontal",      # lay out keys side by side
    legend.title.align = 0.5,   
  
    axis.title.x = element_text(size = 15),  # Increase x-axis label size
    axis.title.y = element_text(size = 15), # Increase y-axis label size
    axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
    axis.ticks = element_line(size = 1),  #adding axis ticks
    axis.ticks.length = unit(0.25, "cm"),
    
    #axis.ticks = element_blank(), #removing axis ticks
    
    axis.line = element_line(colour = "black"),
    panel.grid = element_line(color = "#b4aea9"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(linetype = "dashed"),
    panel.background = element_blank(),
      #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
  )



```





```{r, echo=TRUE}


#summary(m1c)



#graphical presentation of the interaction
 interact_plot(m1c, pred=Hippo_R, modx=avg_positive,
              interval   = TRUE,       # adding CI bands
              plot.points= TRUE,
              jitter = 0.2,
              colors   = c("black", "orange"),
              x.label    = "Hippocampal Volume",
              y.label    = "Film recall",
             legend.main= "Positive content",
             
) + 
  
  theme(
    legend.position    = "bottom",             # move legend above the panel
    #legend.direction   = "horizontal",      # lay out keys side by side
    legend.title.align = 0.5,   
  
    axis.title.x = element_text(size = 15),  # Increase x-axis label size
    axis.title.y = element_text(size = 15), # Increase y-axis label size
    axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
    axis.ticks = element_line(size = 1),  #adding axis ticks
    axis.ticks.length = unit(0.25, "cm"),
    
    #axis.ticks = element_blank(), #removing axis ticks
    
    axis.line = element_line(colour = "black"),
    panel.grid = element_line(color = "#b4aea9"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(linetype = "dashed"),
    panel.background = element_blank(),
      #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
  )



#Neyman plot for slope anaysis
sim_slopes(m1c, pred = Hippo_R, modx = avg_positive, 
           jnplot = TRUE
           )




```




> Neutral Models

```{r, echo=TRUE}
# Fit the multiple linear regression model
m2a <- lm(VD ~ GDS + avg_neutral + Hippo_R, dataX)

m2b <- lm(VD ~ GDS*avg_neutral + Age + sex + edu + films + timedelay, dataX)
#m2b <- lm(VD ~ GDS + avg_neutral + Hippo_R + Age + sex + edu + films + timedelay, dataX)

m2c <- lm(VD ~ avg_neutral*Hippo_R + GDS + Age + sex + edu + films + timedelay, dataX)

m2d <- lm(VD ~ avg_neutral*Hippo_R + GDS*avg_neutral + Age + sex + edu + films + timedelay, dataX)



#to summarize the four model results
texreg::screenreg(list(m2a, m2b, m2c, m2d),
                  caption = "",
          custom.note = "Note: ***p<.001, **p<.01, *p<.05,  
          Model 1: hippo, 
          Model 2: m1a + covariates,
          Model 3: m1b + films,
          Model 4: m1b + GDS,
          Model 5: interaction"
          )

```




```{r}
summary(m2b)



```






```{r}
#graphical presentation of the interaction
 interact_plot(m2b, pred=GDS, modx=avg_neutral,
              interval   = TRUE,       # adding CI bands
              plot.points= TRUE,
              jitter = 0.2,
              colors   = c("black", "hotpink4"),
              x.label    = "Level of depressive symptoms",
              y.label    = "Film recall",
             legend.main= "Neutral content",
             
) + 
  
  theme(
    legend.position    = "bottom",             # move legend above the panel
    #legend.direction   = "horizontal",      # lay out keys side by side
    legend.title.align = 0.5,   
  
    axis.title.x = element_text(size = 15),  # Increase x-axis label size
    axis.title.y = element_text(size = 15), # Increase y-axis label size
    axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
    axis.ticks = element_line(size = 1),  #adding axis ticks
    axis.ticks.length = unit(0.25, "cm"),
    
    #axis.ticks = element_blank(), #removing axis ticks
    
    axis.line = element_line(colour = "black"),
    panel.grid = element_line(color = "#b4aea9"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(linetype = "dashed"),
    panel.background = element_blank(),
      #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
  )



```





```{r, echo=TRUE}


summary(m2c)


```







```{r, echo=TRUE}
#graphical presentation of the interaction
 interact_plot(m2c, pred=Hippo_R, modx=avg_neutral,
              interval   = TRUE,       # adding CI bands
              plot.points= TRUE,
              jitter = 0.2,
              colors   = c("black", "orange"),
              x.label    = "Hippocampal Volume",
              y.label    = "Film recall",
             legend.main= "Neutral content",
             
) + 
  
  theme(
    legend.position    = "bottom",             # move legend above the panel
    #legend.direction   = "horizontal",      # lay out keys side by side
    legend.title.align = 0.5,   
  
    axis.title.x = element_text(size = 15),  # Increase x-axis label size
    axis.title.y = element_text(size = 15), # Increase y-axis label size
    axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
    axis.ticks = element_line(size = 1),  #adding axis ticks
    axis.ticks.length = unit(0.25, "cm"),
    
    #axis.ticks = element_blank(), #removing axis ticks
    
    axis.line = element_line(colour = "black"),
    panel.grid = element_line(color = "#b4aea9"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(linetype = "dashed"),
    panel.background = element_blank(),
      #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
  )



#Neyman plot for slope anaysis
sim_slopes(m2c, pred = Hippo_R, modx = avg_neutral, 
           jnplot = TRUE
           )







```




> Negative Models

```{r, echo=TRUE}
# Fit the multiple linear regression model
m3a <- lm(VD ~ GDS + avg_negative + Hippo_R, dataX)

m3b <- lm(VD ~ GDS*avg_negative + Age + sex + edu + films + timedelay, dataX)
#m3b <- lm(VD ~ GDS*avg_negative + Hippo_R + Age + sex + edu + films + timedelay, dataX)

m3c <- lm(VD ~ avg_negative*Hippo_R + GDS + Age + sex + edu + films + timedelay, dataX)

m3d <- lm(VD ~ avg_negative*Hippo_R + GDS*avg_negative + Age + sex + edu + films + timedelay, dataX)



#to summarize the four model results
texreg::screenreg(list(m3a, m3b, m3c, m3d),
                  caption = "",
          custom.note = "Note: ***p<.001, **p<.01, *p<.05,  
          Model 1: hippo, 
          Model 2: m1a + covariates,
          Model 3: m1b + films,
          Model 4: m1b + GDS,
          Model 5: interaction"
          )

```


#replicating

```{r}
summary(m3b)


```






```{r}
#graphical presentation of the interaction
#  interact_plot(m3b, pred=GDS, modx=avg_negative,
#               interval   = TRUE,       # adding CI bands
#               plot.points= TRUE,
#               jitter = 0.2,
#               colors   = c("black", "brown4"),
#               x.label    = "Level of depressive symptoms",
#               y.label    = "Film recall",
#              legend.main= "Negative content",
#              
# ) + 
#   
#   theme(
#     legend.position    = "bottom",             # move legend above the panel
#     #legend.direction   = "horizontal",      # lay out keys side by side
#     legend.title.align = 0.5,   
#   
#     axis.title.x = element_text(size = 15),  # Increase x-axis label size
#     axis.title.y = element_text(size = 15), # Increase y-axis label size
#     axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
#     axis.ticks = element_line(size = 1),  #adding axis ticks
#     axis.ticks.length = unit(0.25, "cm"),
#     
#     #axis.ticks = element_blank(), #removing axis ticks
#     
#     axis.line = element_line(colour = "black"),
#     panel.grid = element_line(color = "#b4aea9"),
#     panel.grid.minor = element_blank(),
#     panel.grid.major.x = element_blank(),
#     panel.grid.major.y = element_line(linetype = "dashed"),
#     panel.background = element_blank(),
#       #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
#     #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
#   )




```






```{r, echo=TRUE}
summary(m3c)



```







```{r, echo=TRUE}
#graphical presentation of the interaction
 interact_plot(m3c, pred=Hippo_R, modx=avg_negative,
              interval   = TRUE,       # adding CI bands
              plot.points= TRUE,
              jitter = 0.2,
              colors   = c("black", "orange"),
              x.label    = "Hippocampal Volume",
              y.label    = "Film recall",
             legend.main= "Negative content",
             
) + 
  
  theme(
    legend.position    = "bottom",             # move legend above the panel
    #legend.direction   = "horizontal",      # lay out keys side by side
    legend.title.align = 0.5,   
  
    axis.title.x = element_text(size = 15),  # Increase x-axis label size
    axis.title.y = element_text(size = 15), # Increase y-axis label size
    axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
    axis.ticks = element_line(size = 1),  #adding axis ticks
    axis.ticks.length = unit(0.25, "cm"),
    
    #axis.ticks = element_blank(), #removing axis ticks
    
    axis.line = element_line(colour = "black"),
    panel.grid = element_line(color = "#b4aea9"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(linetype = "dashed"),
    panel.background = element_blank(),
      #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
  )



#Neyman plot for slope anaysis
sim_slopes(m3c, pred = Hippo_R, modx = avg_negative, 
           jnplot = TRUE
           )




```



&nbsp;

 ## Amygdala Models
 
> Positive Models


```{r}
# Fit the multiple linear regression model
m4a <- lm(VD ~ GDS + avg_positive + Amyg_R, dataX)

m4b <- lm(VD ~ GDS*avg_positive + Age + sex + edu + films + timedelay, dataX)

m4c <- lm(VD ~ avg_positive*Amyg_R + GDS + Age + sex + edu + films + timedelay, dataX)

m4d <- lm(VD ~ avg_positive*Amyg_R + avg_positive*GDS + Age + sex + edu + films + timedelay, dataX)



#to summarize the four model results
texreg::screenreg(list(m4a, m4b, m4c, m4d),
                  caption = "",
          custom.note = "Note: ***p<.001, **p<.01, *p<.05,  
          Model 1: hippo, 
          Model 2: m1a + covariates,
          Model 3: m1b + films,
          Model 4: m1b + GDS,
          Model 5: interaction"
          )


```





```{r}

summary(m4b)

summary(m4c)

summary(m4d)


```





## Graphical presentations of model 4d

> interaction: Amygdala:positive

```{r}

#graphical presentation of the interaction
 interact_plot(m4c, pred=Amyg_R, modx=avg_positive,
              interval   = TRUE,       # adding CI bands
              plot.points= TRUE,
              jitter = 0.2,
              colors   = c("black", "forestgreen"),
              x.label    = "Amygdala volume",
              y.label    = "Film recall",
             legend.main= "Positive content",
             
) + 
  
  theme(
    legend.position    = "bottom",             # move legend above the panel
    #legend.direction   = "horizontal",      # lay out keys side by side
    legend.title.align = 0.5,   
  
    axis.title.x = element_text(size = 15),  # Increase x-axis label size
    axis.title.y = element_text(size = 15), # Increase y-axis label size
    axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
    axis.ticks = element_line(size = 1),  #adding axis ticks
    axis.ticks.length = unit(0.25, "cm"),
    
    #axis.ticks = element_blank(), #removing axis ticks
    
    axis.line = element_line(colour = "black"),
    panel.grid = element_line(color = "#b4aea9"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(linetype = "dashed"),
    panel.background = element_blank(),
      #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
  )



#Neyman plot for slope anaysis
sim_slopes(m4c, pred = Amyg_R, modx = avg_positive, 
           jnplot = TRUE
           )


```



> interaction: GDS:positive

```{r}

# #graphical presentation of the interaction
#  interact_plot(m4d, pred=GDS, modx=avg_positive,
#               interval   = TRUE,       # adding CI bands
#               plot.points= TRUE,
#               jitter = 0.2,
#               colors   = c("black", "coral"),
#               x.label    = "level of depressive symptoms",
#               y.label    = "Film recall",
#              legend.main= "Positive sentiment",
#              
# ) + 
#   
#   theme(
#     legend.position    = "bottom",             # move legend above the panel
#     #legend.direction   = "horizontal",      # lay out keys side by side
#     legend.title.align = 0.5,   
#   
#     axis.title.x = element_text(size = 15),  # Increase x-axis label size
#     axis.title.y = element_text(size = 15), # Increase y-axis label size
#     axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
#     axis.ticks = element_line(size = 1),  #adding axis ticks
#     axis.ticks.length = unit(0.25, "cm"),
#     
#     #axis.ticks = element_blank(), #removing axis ticks
#     
#     axis.line = element_line(colour = "black"),
#     panel.grid = element_line(color = "#b4aea9"),
#     panel.grid.minor = element_blank(),
#     panel.grid.major.x = element_blank(),
#     panel.grid.major.y = element_line(linetype = "dashed"),
#     panel.background = element_blank(),
#       #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
#     #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
#   )
# 
# 
# 
# #Neyman plot for slope anaysis
# sim_slopes(m4d, pred = GDS, modx = avg_positive, 
#            jnplot = TRUE
#            )




```


> interaction: Amygdala:GDS


```{r}



# #graphical presentation of the interaction
#  interact_plot(m4d, pred=Amyg_R, modx=GDS,
#               interval   = TRUE,       # adding CI bands
#               plot.points= TRUE,
#               jitter = 0.2,
#               colors   = c("black", "coral"),
#               x.label    = "Amygdala volume",
#               y.label    = "Film recall",
#              legend.main= "level of depressive symptoms",
#              
# ) + 
#   
#   theme(
#     legend.position    = "bottom",             # move legend above the panel
#     #legend.direction   = "horizontal",      # lay out keys side by side
#     legend.title.align = 0.5,   
#   
#     axis.title.x = element_text(size = 15),  # Increase x-axis label size
#     axis.title.y = element_text(size = 15), # Increase y-axis label size
#     axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
#     axis.ticks = element_line(size = 1),  #adding axis ticks
#     axis.ticks.length = unit(0.25, "cm"),
#     
#     #axis.ticks = element_blank(), #removing axis ticks
#     
#     axis.line = element_line(colour = "black"),
#     panel.grid = element_line(color = "#b4aea9"),
#     panel.grid.minor = element_blank(),
#     panel.grid.major.x = element_blank(),
#     panel.grid.major.y = element_line(linetype = "dashed"),
#     panel.background = element_blank(),
#       #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
#     #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
#   )
# 
# 
# 
# #Neyman plot for slope anaysis
# sim_slopes(m4d, pred = Amyg_R, modx = GDS, 
#            jnplot = TRUE
#            )


```








> Neutral Models


```{r}
# Fit the multiple linear regression model
m5a <- lm(VD ~ GDS + avg_neutral + Amyg_R, dataX)

m5b <- lm(VD ~ GDS*avg_neutral + Age + sex + edu + films + timedelay, dataX)

m5c <- lm(VD ~ avg_neutral*Amyg_R + GDS + Age + sex + edu + films + timedelay, dataX)

m5d <- lm(VD ~ avg_neutral*Amyg_R + avg_neutral*GDS + Age + sex + edu + films + timedelay, dataX)



#to summarize the four model results
texreg::screenreg(list(m5a, m5b, m5c, m5d),
                  caption = "",
          custom.note = "Note: ***p<.001, **p<.01, *p<.05,  
          Model 1: hippo, 
          Model 2: m1a + covariates,
          Model 3: m1b + films,
          Model 4: m1b + GDS,
          Model 5: interaction"
          )


```





```{r}


summary(m5b)

summary(m5c)

summary(m5d)







```




## Graphical presentations of model 5d

> interaction: Amygdala:Neutral

```{r}

#graphical presentation of the interaction
 interact_plot(m5c, pred=Amyg_R, modx=avg_neutral,
              interval   = TRUE,       # adding CI bands
              plot.points= TRUE,
              jitter = 0.2,
              colors   = c("black", "forestgreen"),
              x.label    = "Amygdala volume",
              y.label    = "Film recall",
             legend.main= "Neutral content",
             
) + 
  
  theme(
    legend.position    = "bottom",             # move legend above the panel
    #legend.direction   = "horizontal",      # lay out keys side by side
    legend.title.align = 0.5,   
  
    axis.title.x = element_text(size = 15),  # Increase x-axis label size
    axis.title.y = element_text(size = 15), # Increase y-axis label size
    axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
    axis.ticks = element_line(size = 1),  #adding axis ticks
    axis.ticks.length = unit(0.25, "cm"),
    
    #axis.ticks = element_blank(), #removing axis ticks
    
    axis.line = element_line(colour = "black"),
    panel.grid = element_line(color = "#b4aea9"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(linetype = "dashed"),
    panel.background = element_blank(),
      #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
  )



#Neyman plot for slope anaysis
sim_slopes(m5c, pred = Amyg_R, modx = avg_neutral, 
           jnplot = TRUE
           )




```





> interaction: GDS:Neutral


```{r}



#graphical presentation of the interaction
#  interact_plot(m5b, pred=GDS, modx=avg_neutral,
#               interval   = TRUE,       # adding CI bands
#               plot.points= TRUE,
#               jitter = 0.2,
#               colors   = c("black", "turquoise"),
#               x.label    = "Level of depressive symptoms",
#               y.label    = "Film recall",
#              legend.main= "Neutral sentiment",
#              
# ) + 
#   
#   theme(
#     legend.position    = "bottom",             # move legend above the panel
#     #legend.direction   = "horizontal",      # lay out keys side by side
#     legend.title.align = 0.5,   
#   
#     axis.title.x = element_text(size = 15),  # Increase x-axis label size
#     axis.title.y = element_text(size = 15), # Increase y-axis label size
#     axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
#     axis.ticks = element_line(size = 1),  #adding axis ticks
#     axis.ticks.length = unit(0.25, "cm"),
#     
#     #axis.ticks = element_blank(), #removing axis ticks
#     
#     axis.line = element_line(colour = "black"),
#     panel.grid = element_line(color = "#b4aea9"),
#     panel.grid.minor = element_blank(),
#     panel.grid.major.x = element_blank(),
#     panel.grid.major.y = element_line(linetype = "dashed"),
#     panel.background = element_blank(),
#       #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
#     #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
#   )



# #Neyman plot for slope anaysis
# sim_slopes(m5d, pred = GDS, modx = avg_neutral, 
#            jnplot = TRUE
#            )




```














> Negative Models


```{r}
m6a <- lm(VD ~ GDS + avg_negative + Amyg_R, dataX)

m6b <- lm(VD ~ GDS*avg_negative + Age + sex + edu + films + timedelay, dataX)

m6c <- lm(VD ~ avg_negative*Amyg_R + GDS + Age + sex + edu + films + timedelay, dataX)

m6d <- lm(VD ~ avg_negative*Amyg_R + GDS*avg_negative + Age + sex + edu + films + timedelay, dataX)



#to summarize the four model results
texreg::screenreg(list(m6a, m6b, m6c, m6d),
                  caption = "",
          custom.note = "Note: ***p<.001, **p<.01, *p<.05,  
          Model 1: hippo, 
          Model 2: m1a + covariates,
          Model 3: m1b + films,
          Model 4: m1b + GDS,
          Model 5: interaction"
          )


```






```{r}

summary(m6b)

summary(m6c)

#summary(m6d)







```






&nbsp;

## Medial Temporal Lobe


```{r}

#composite score for MTL
dataX <- dataX %>%
  mutate(
    MTL = rowMeans(
      dplyr::select(., 'L_amyg_r', 'R_amyg_r', 'L_hippo_r', 'R_hippo_r'),
      na.rm = TRUE
    )
  )


#Correlations
mycor2 <- dataX %>% 
  dplyr::select(VD, Age, Education, GDS, MTL, avg_negative, avg_neutral, avg_positive) 

apa.cor.table(mycor2,
              filename = "Correlation2_with_MTL.doc",
              table.number = 2)


```





> MTL Models: positive

```{r}
m7a <- lm(VD ~ MTL + avg_positive, dataX)
m7b <- lm(VD ~ MTL + avg_positive + GDS + Age + sex + edu + films + timedelay, dataX)
m7c <- lm(VD ~ MTL*avg_positive + GDS + Age + sex + edu + films + timedelay, dataX)
m7d <- lm(VD ~ MTL*GDS*avg_positive + Age + sex + edu + films + timedelay, dataX) #no interaction


#to summarize the four model results
texreg::screenreg(list(m7a, m7b, m7c, m7d),
                  caption = "",
          custom.note = "Note: ***p<.001, **p<.01, *p<.05,  
          Model 1: hippo, 
          Model 2: m1a + covariates,
          Model 3: m1b + films,
          Model 4: m1b + GDS,
          Model 5: interaction"
          )


```





```{r}

#Best model: Model 3

summary(m7c)


#graphical presentation of the interaction
 interact_plot(m7c, pred=MTL, modx=avg_positive,
              interval   = TRUE,       # adding CI bands
              plot.points= TRUE,
              jitter = 0.2,
              colors   = c("black", "orange"),
              x.label    = "Medial Temporal Lobe Volume",
              y.label    = "Film recall",
             legend.main= "Positive sentiment",
             
) + 
  
  theme(
    legend.position    = "bottom",             # move legend above the panel
    #legend.direction   = "horizontal",      # lay out keys side by side
    legend.title.align = 0.5,   
  
    axis.title.x = element_text(size = 15),  # Increase x-axis label size
    axis.title.y = element_text(size = 15), # Increase y-axis label size
    axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
    axis.ticks = element_line(size = 1),  #adding axis ticks
    axis.ticks.length = unit(0.25, "cm"),
    
    #axis.ticks = element_blank(), #removing axis ticks
    
    axis.line = element_line(colour = "black"),
    panel.grid = element_line(color = "#b4aea9"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(linetype = "dashed"),
    panel.background = element_blank(),
      #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
  )



#Neyman plot for slope anaysis
sim_slopes(m7c, pred = MTL, modx = avg_positive, 
           jnplot = TRUE
           )




```






> MTL Models: neutral

```{r}
m8a <- lm(VD ~ MTL + avg_neutral, dataX)
m8b <- lm(VD ~ MTL + avg_neutral + GDS + Age + sex + edu + films + timedelay, dataX)
m8c <- lm(VD ~ MTL*avg_neutral + GDS + Age + sex + edu + films + timedelay, dataX)
m8d <- lm(VD ~ MTL*avg_neutral + GDS*avg_neutral + Age + sex + edu + films + timedelay, dataX) 


#to summarize the four model results
texreg::screenreg(list(m8a, m8b, m8c, m8d),
                  caption = "",
          custom.note = "Note: ***p<.001, **p<.01, *p<.05,  
          Model 1: hippo, 
          Model 2: m1a + covariates,
          Model 3: m1b + films,
          Model 4: m1b + GDS,
          Model 5: interaction"
          )


```


```{r}

# Best model: Model 3
summary(m8c)



#graphical presentation of the interaction
 interact_plot(m8c, pred=MTL, modx=avg_neutral,
              interval   = TRUE,       # adding CI bands
              plot.points= TRUE,
              jitter = 0.2,
              colors   = c("black", "turquoise"),
              x.label    = "Medial Temporal Lobe Volume",
              y.label    = "Film recall",
             legend.main= "Neutral sentiment",
             
) + 
  
  theme(
    legend.position    = "bottom",             # move legend above the panel
    #legend.direction   = "horizontal",      # lay out keys side by side
    legend.title.align = 0.5,   
  
    axis.title.x = element_text(size = 15),  # Increase x-axis label size
    axis.title.y = element_text(size = 15), # Increase y-axis label size
    axis.text = element_text(size = 15), #increasing the font for the numbers on the axis
    axis.ticks = element_line(size = 1),  #adding axis ticks
    axis.ticks.length = unit(0.25, "cm"),
    
    #axis.ticks = element_blank(), #removing axis ticks
    
    axis.line = element_line(colour = "black"),
    panel.grid = element_line(color = "#b4aea9"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(linetype = "dashed"),
    panel.background = element_blank(),
      #element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    #plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4")
  )



#Neyman plot for slope anaysis
sim_slopes(m8c, pred = MTL, modx = avg_neutral, 
           jnplot = TRUE
           )





```





> MTL Models: negative

```{r}
m9a <- lm(VD ~ MTL + avg_negative, dataX)
m9b <- lm(VD ~ MTL + avg_negative + GDS + Age + sex + edu + films + timedelay, dataX)
m9c <- lm(VD ~ MTL*avg_negative + GDS + Age + sex + edu + films + timedelay, dataX)
m9d <- lm(VD ~ MTL*GDS*avg_negative + Age + sex + edu + films + timedelay, dataX) #no threeway-interaction


#to summarize the four model results
texreg::screenreg(list(m9a, m9b, m9c, m9d),
                  caption = "",
          custom.note = "Note: ***p<.001, **p<.01, *p<.05,  
          Model 1: hippo, 
          Model 2: m1a + covariates,
          Model 3: m1b + films,
          Model 4: m1b + GDS,
          Model 5: interaction"
          )


```


```{r}

summary(m9c)




```






#testing & comparing the models above

```{r}

#the model with the highest R-squared value
#checking model 1e assumptions
# check_model(m1d)
# 
# model_performance(m1d)




```


```{r}

#comparing models performance
# compare_performance(m1a, m1b, m1c, m1d)
# 
# plot(compare_performance(m1a, m1b, m1c, m1d, rank = TRUE, verbose = FALSE))

```






GDS as a dependent variable

```{r, echo=TRUE}

# m7a <- lm(GDS ~ Hippo_R*Amyg_R, dataX)
# 
# m7b <- lm(GDS ~ Hippo_R*Amyg_R + Age + sex + edu + films + timedelay, dataX)
# 
# m7c <- lm(GDS ~ Hippo_R*Amyg_R + VD + Age + sex + edu + films + timedelay, dataX)
# 
# #m2d <- lm(residual_hippo ~ VD + episodic + GDS + Age + sex + edu + timedelay, dataX)
# 
# 
# #to summarize the four model results
# texreg::screenreg(list(m7a, m7b, m7c),
#                   caption = "",
#           custom.note = "Note: ***p<.001, **p<.01, *p<.05,
#           Model 1: VD,
#           Model 2: m2a + covariates,
#           Model 3: m2b + episodic,
#           Model 4: m2b + GDS"
#           #Model 3: affect"
#           )
# 
# 
# #summary(m2a)

```



```{r}


nice_scatter(dataX, predictor ="MTL", response = "VD", 
             ytitle = "Film recall",
             xtitle = "Medial Temporal Lobe volume",
             #has.points = FALSE,
             has.jitter = TRUE,
             alpha = .7,
             #has.confband = TRUE,
             #has.fullrange = TRUE,
             has.r = TRUE, r.x =-400, r.y = 90, 
             has.p = TRUE, p.x =-300, p.y = 85, 
            ) + 
  
  #adding this function to get a customized color for line & confidence bands
  geom_smooth(
    method = "lm", 
    se     = TRUE, 
    color  = "black",       # regression line
    fill   = "brown",   # ribbon color
    #alpha  = 0.3
  ) +
  
  #to customize the theme such as font size
  theme(
    axis.title.x = element_text(size = 18),  # choose whatever point size you like
    axis.title.y = element_text(size = 18)
  )

```



```{r}



```



```{r}







```









